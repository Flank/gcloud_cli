- release_tracks: [BETA]
  help_text:
    brief:  Create a Cloud Filestore snapshot.
    description: |
      Create a Cloud Filestore snapshot of an instance.

      This command can fail for the following reasons:
        * A snapshot with the same name already exists.
        * The active account does not have permission to create snapshots.
        * Maximum amount of snapshots for the instance has been reached.
    examples: |
      To create a snapshot with the name 'my-snapshot' and description 'My snapshot description' for
      a particular instance like 'my-instance' from 'us-central1', run:

        $ {command} my-snapshot \
          --instance=my-instance \
          --instance-region=us-central1 \
          --description="My snapshot description" \
          --labels "name1=value1,name2=value2"

  arguments:
    params:
    - arg_name: snapshot
      is_positional: true
      required: true
      help_text: |
        Name of the Filestore snapshot to be created.
    - arg_name: instance
      required: true
      help_text: |
        Name of the Filestore instance you want to snapshot.
    - arg_name: instance-region
      required: true
      help_text: |
        Region of the Filestore instance.
    - api_field: snapshot.description
      arg_name: description
      required: false
      help_text: |
        Description for the snapshot. Limit: 2048 characters.
    - api_field: snapshot.labels.additionalProperties
      arg_name: labels
      metavar: KEY=VALUE
      required: false
      help_text: |
        List of label KEY=VALUE pairs to add.
      type:
        arg_dict:
          flatten: true
          spec:
          - api_field: key
          - api_field: value

  async:
    collection: file.projects.locations.operations

  request:
    BETA:
      api_version: v1beta1
    display_resource_type: snapshot
    collection: file.projects.locations.instances.snapshots
    # Disable validating that a snapshot resource arg is specified (as we are using the
    # file.projects.locations.instances.snapshots collection). This collection is populated manually.
    disable_resource_check: true
    modify_request_hooks:
    - googlecloudsdk.command_lib.filestore.instances.snapshots.util:FormatSnapshotCreateRequest
