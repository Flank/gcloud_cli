title: "'run code ... --appengine' uses --build-context-directory to find app.yaml"
release_tracks: [ALPHA]
summary:
# This summary is generated by http://go/gcloud-scenario-tests on update and should not be edited.
- execute:
  - command: code export --appengine --source=other_dir/
  - write_file: pods_and_services.yaml
  - write_file: skaffold.yaml
actions:
- define_reference:
    reference: some_gae_supported_runtime
    value: python37
- write_file:
    path: other_dir/app.yaml
    contents: |
      runtime: $$some_gae_supported_runtime$$
- execute_command:
    command: code export --appengine --source=other_dir/
    events:
    - expect_file_written:
        path: pods_and_services.yaml
        contents:
          matches: .*
    - expect_file_written:
        path: skaffold.yaml
        contents:
          matches: '.*builder: gcr\.io/gae-runtimes/buildpacks/$$some_gae_supported_runtime$$/builder:argo_current.*'
    - expect_exit:
        code: 0
