title: artifacts docker images list flags
release_tracks: [ALPHA, BETA]
summary:
# This summary is generated by http://go/gcloud-scenario-tests on update and should not be edited.
- execute:
  - command: config set artifacts/location us-west1
  - stderr: |
      Updated property [artifacts/location].
- execute:
  - command: config set artifacts/repository my-repo
  - stderr: |
      Updated property [artifacts/repository].
- execute:
  - command: artifacts docker images list --show-occurrences
  - stderr: ^Listing items under project fake-project, location us-west1, repository
      my-repo..*$
  - stdout: |
      IMAGE                                                  DIGEST         CREATE_TIME          UPDATE_TIME          VULNERABILITIES
      us-west1-docker.pkg.dev/fake-project/my-repo/my-image  sha256:bbb222  2019-04-10T17:23:53  2019-04-10T17:23:53  CRITICAL=1,HIGH=1
      us-west1-docker.pkg.dev/fake-project/my-repo/my-image  sha256:ccc333  2019-04-10T15:08:46  2019-04-10T15:08:46
      us-west1-docker.pkg.dev/fake-project/my-repo/my-image  sha256:aaa111  2019-04-10T15:08:45  2019-04-10T15:08:45  CRITICAL=1
- execute:
  - command: artifacts docker images list us-west1-docker.pkg.dev/fake-project/my-repo
      --show-occurrences --show-occurrences-from 1
  - stderr: ^Listing items under project fake-project, location us-west1, repository
      my-repo..*$
  - stdout: |
      IMAGE                                                  DIGEST         CREATE_TIME          UPDATE_TIME          VULNERABILITIES
      us-west1-docker.pkg.dev/fake-project/my-repo/my-image  sha256:bbb222  2019-04-10T17:23:53  2019-04-10T17:23:53  CRITICAL=1,HIGH=1
- execute:
  - command: artifacts docker images list us-west1-docker.pkg.dev/fake-project/my-repo
      --show-occurrences --occurrence-filter 'kind="BUILD"' --format=yaml
  - stderr: ^Listing items under project fake-project, location us-west1, repository
      my-repo..*$
  - stdout: |
      ---
      createTime: '2019-04-11T00:23:53.184760Z'
      package: us-west1-docker.pkg.dev/fake-project/my-repo/my-image
      tags: ''
      updateTime: '2019-04-11T00:23:53.184760Z'
      version: sha256:bbb222
      vuln_counts:
        CRITICAL: 1
        HIGH: 1
      ---
      BUILD:
      - build:
          provenance:
            buildVersion: 1.1.5
            creator: fake-creator@fake-mail.com
            id: fake-build-id
        kind: BUILD
        name: projects/fake-project/occurrences/3
        noteName: projects/build-project/notes/1
        resourceUri: us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:ccc333
      createTime: '2019-04-10T22:08:46.246729Z'
      package: us-west1-docker.pkg.dev/fake-project/my-repo/my-image
      tags: ''
      updateTime: '2019-04-10T22:08:46.246729Z'
      version: sha256:ccc333
      ---
      createTime: '2019-04-10T22:08:45.773883Z'
      package: us-west1-docker.pkg.dev/fake-project/my-repo/my-image
      tags: ''
      updateTime: '2019-04-10T22:08:45.773883Z'
      version: sha256:aaa111
actions:
- execute_command:
    command: config set artifacts/location us-west1
    events:
    - expect_stderr: |
        Updated property [artifacts/location].
    - expect_exit:
        code: 0
- execute_command:
    command: config set artifacts/repository my-repo
    events:
    - expect_stderr: |
        Updated property [artifacts/repository].
    - expect_exit:
        code: 0
- execute_command:
    command: artifacts docker images list --show-occurrences
    events:
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            locations:
            - name: projects/fake-project/locations/us-west1
              locationId: us-west1
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "name": "projects/fake-project/locations/us-west1/repositories/my-repo",
              "format": "DOCKER"
            }
    - expect_stderr:
        matches: ^Listing items under project fake-project, location us-west1, repository
          my-repo..*
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo/packages?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            packages:
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image
              displayName: 'null'
              updateTime: '2019-04-10T22:49:53.815214Z'
              createTime: '2019-04-10T22:49:53.815214Z'
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions?alt=json&view=BASIC
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            versions:
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:aaa111
              description: desc
              updateTime: '2019-04-10T22:08:45.773883Z'
              createTime: '2019-04-10T22:08:45.773883Z'
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:bbb222
              description: null
              updateTime: '2019-04-11T00:23:53.184760Z'
              createTime: '2019-04-11T00:23:53.184760Z'
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:ccc333
              description: another-desc
              updateTime: '2019-04-10T22:08:46.246729Z'
              createTime: '2019-04-10T22:08:46.246729Z'
    - api_call:
        expect_request:
          uri: https://containeranalysis.googleapis.com/v1/projects/fake-project/occurrences?alt=json&filter=%28%28has_prefix%28resourceUrl%2C+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%22%29%29+AND+%28kind%3D%22BUILD%22+OR+kind%3D%22IMAGE%22+OR+kind%3D%22DISCOVERY%22%29%29+AND+%28%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Abbb222%22%29+OR+%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Accc333%22%29+OR+%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Aaaa111%22%29%29&pageSize=1000
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "occurrences": [
                {
                  "name": "projects/fake-project/occurrences/1",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:aaa111",
                  "kind": "VULNERABILITY",
                  "noteName": "projects/vulnz-project/notes/1",
                  "vulnerability": {
                    "cvssScore": 10.0,
                    "severity": "CRITICAL"
                  }
                },
                {
                  "name": "projects/fake-project/occurrences/2",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:aaa111",
                  "kind": "DISCOVERY",
                  "noteName": "projects/analysis-project/notes/PACKAGE_VULNERABILITY",
                  "discovery": {
                    "continousAnalysis": "ACTIVE",
                    "analysisStatus": "FINISHED_SUCCESS"
                  }
                },
                {
                  "name": "projects/fake-project/occurrences/3",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "kind": "VULNERABILITY",
                  "noteName": "projects/vulnz-project/notes/1",
                  "vulnerability": {
                    "cvssScore": 10.0,
                    "severity": "CRITICAL"
                  }
                },
                {
                  "name": "projects/fake-project/occurrences/4",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "kind": "VULNERABILITY",
                  "noteName": "projects/vulnz-project/notes/1",
                  "vulnerability": {
                    "cvssScore": 10.0,
                    "severity": "HIGH"
                  }
                },
                {
                  "name": "projects/fake-project/occurrences/5",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "kind": "DISCOVERY",
                  "noteName": "projects/analysis-project/notes/PACKAGE_VULNERABILITY",
                  "discovery": {
                    "continousAnalysis": "ACTIVE",
                    "analysisStatus": "FINISHED_SUCCESS"
                  }
                },
                {
                  "name": "projects/fake-project/occurrences/6",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:ccc333",
                  "kind": "DISCOVERY",
                  "noteName": "projects/analysis-project/notes/PACKAGE_VULNERABILITY",
                  "discovery": {
                    "continousAnalysis": "ACTIVE",
                    "analysisStatus": "PENDING"
                  }
                }
              ]
            }
    - api_call:
        expect_request:
          uri: https://containeranalysis.googleapis.com/v1/projects/fake-project/occurrences:vulnerabilitySummary?alt=json&filter=%28%28has_prefix%28resourceUrl%2C+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%22%29%29%29+AND+%28%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Abbb222%22%29+OR+%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Accc333%22%29+OR+%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Aaaa111%22%29%29
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "counts": [
                {
                  "severity": "SEVERITY_UNSPECIFIED",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:aaa111",
                  "fixableCount": 1,
                  "totalCount": 1
                },
                {
                  "severity": "CRITICAL",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:aaa111",
                  "fixableCount": 1,
                  "totalCount": 1
                },
                {
                  "severity": "SEVERITY_UNSPECIFIED",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 1,
                  "totalCount": 2
                },
                {
                  "severity": "CRITICAL",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 1,
                  "totalCount": 1
                },
                {
                  "severity": "HIGH",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 0,
                  "totalCount": 1
                }
              ]
            }
    - expect_stdout: |
        IMAGE                                                  DIGEST         CREATE_TIME          UPDATE_TIME          VULNERABILITIES
        us-west1-docker.pkg.dev/fake-project/my-repo/my-image  sha256:bbb222  2019-04-10T17:23:53  2019-04-10T17:23:53  CRITICAL=1,HIGH=1
        us-west1-docker.pkg.dev/fake-project/my-repo/my-image  sha256:ccc333  2019-04-10T15:08:46  2019-04-10T15:08:46
        us-west1-docker.pkg.dev/fake-project/my-repo/my-image  sha256:aaa111  2019-04-10T15:08:45  2019-04-10T15:08:45  CRITICAL=1
    - expect_exit:
        code: 0
- execute_command:
    command: artifacts docker images list us-west1-docker.pkg.dev/fake-project/my-repo
      --show-occurrences --show-occurrences-from 1
    events:
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            locations:
            - name: projects/fake-project/locations/us-west1
              locationId: us-west1
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "name": "projects/fake-project/locations/us-west1/repositories/my-repo",
              "format": "DOCKER"
            }
    - expect_stderr:
        matches: ^Listing items under project fake-project, location us-west1, repository
          my-repo..*
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo/packages?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            packages:
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image
              displayName: 'null'
              updateTime: '2019-04-10T22:49:53.815214Z'
              createTime: '2019-04-10T22:49:53.815214Z'
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions?alt=json&view=BASIC
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            versions:
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:aaa111
              description: desc
              updateTime: '2019-04-10T22:08:45.773883Z'
              createTime: '2019-04-10T22:08:45.773883Z'
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:bbb222
              description: null
              updateTime: '2019-04-11T00:23:53.184760Z'
              createTime: '2019-04-11T00:23:53.184760Z'
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:ccc333
              description: another-desc
              updateTime: '2019-04-10T22:08:46.246729Z'
              createTime: '2019-04-10T22:08:46.246729Z'
    - api_call:
        expect_request:
          uri: https://containeranalysis.googleapis.com/v1/projects/fake-project/occurrences?alt=json&filter=%28%28has_prefix%28resourceUrl%2C+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%22%29%29+AND+%28kind%3D%22BUILD%22+OR+kind%3D%22IMAGE%22+OR+kind%3D%22DISCOVERY%22%29%29+AND+%28%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Abbb222%22%29%29&pageSize=1000
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "occurrences": [
                {
                  "name": "projects/fake-project/occurrences/3",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "kind": "VULNERABILITY",
                  "noteName": "projects/vulnz-project/notes/1",
                  "vulnerability": {
                    "cvssScore": 10.0,
                    "severity": "CRITICAL"
                  }
                },
                {
                  "name": "projects/fake-project/occurrences/4",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "kind": "VULNERABILITY",
                  "noteName": "projects/vulnz-project/notes/1",
                  "vulnerability": {
                    "cvssScore": 10.0,
                    "severity": "HIGH"
                  }
                },
                {
                  "name": "projects/fake-project/occurrences/5",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "kind": "DISCOVERY",
                  "noteName": "projects/analysis-project/notes/PACKAGE_VULNERABILITY",
                  "discovery": {
                    "continousAnalysis": "ACTIVE",
                    "analysisStatus": "FINISHED_SUCCESS"
                  }
                }
              ]
            }
    - api_call:
        expect_request:
          uri: https://containeranalysis.googleapis.com/v1/projects/fake-project/occurrences:vulnerabilitySummary?alt=json&filter=%28%28has_prefix%28resourceUrl%2C+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%22%29%29%29+AND+%28%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Abbb222%22%29%29
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "counts": [
                {
                  "severity": "SEVERITY_UNSPECIFIED",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 1,
                  "totalCount": 2
                },
                {
                  "severity": "CRITICAL",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 1,
                  "totalCount": 1
                },
                {
                  "severity": "HIGH",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 0,
                  "totalCount": 1
                }
              ]
            }
    - expect_stdout: |
        IMAGE                                                  DIGEST         CREATE_TIME          UPDATE_TIME          VULNERABILITIES
        us-west1-docker.pkg.dev/fake-project/my-repo/my-image  sha256:bbb222  2019-04-10T17:23:53  2019-04-10T17:23:53  CRITICAL=1,HIGH=1
    - expect_exit:
        code: 0
- execute_command:
    command: artifacts docker images list us-west1-docker.pkg.dev/fake-project/my-repo
      --show-occurrences --occurrence-filter 'kind="BUILD"' --format=yaml
    events:
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            locations:
            - name: projects/fake-project/locations/us-west1
              locationId: us-west1
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "name": "projects/fake-project/locations/us-west1/repositories/my-repo",
              "format": "DOCKER"
            }
    - expect_stderr:
        matches: ^Listing items under project fake-project, location us-west1, repository
          my-repo..*
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo/packages?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            packages:
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image
              displayName: 'null'
              updateTime: '2019-04-10T22:49:53.815214Z'
              createTime: '2019-04-10T22:49:53.815214Z'
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta2/projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions?alt=json&view=BASIC
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body:
            versions:
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:aaa111
              description: desc
              updateTime: '2019-04-10T22:08:45.773883Z'
              createTime: '2019-04-10T22:08:45.773883Z'
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:bbb222
              description: null
              updateTime: '2019-04-11T00:23:53.184760Z'
              createTime: '2019-04-11T00:23:53.184760Z'
            - name: projects/fake-project/locations/us-west1/repositories/my-repo/packages/my-image/versions/sha256:ccc333
              description: another-desc
              updateTime: '2019-04-10T22:08:46.246729Z'
              createTime: '2019-04-10T22:08:46.246729Z'
    - api_call:
        expect_request:
          uri: https://containeranalysis.googleapis.com/v1/projects/fake-project/occurrences?alt=json&filter=%28%28has_prefix%28resourceUrl%2C+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%22%29%29+AND+%28kind%3D%22BUILD%22%29%29+AND+%28%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Abbb222%22%29+OR+%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Accc333%22%29+OR+%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Aaaa111%22%29%29&pageSize=1000
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "occurrences": [
                {
                  "name": "projects/fake-project/occurrences/3",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:ccc333",
                  "kind": "BUILD",
                  "noteName": "projects/build-project/notes/1",
                  "build": {
                    "provenance": {
                      "id": "fake-build-id",
                      "creator": "fake-creator@fake-mail.com",
                      "buildVersion": "1.1.5"
                    }
                  }
                }
              ]
            }
    - api_call:
        expect_request:
          uri: https://containeranalysis.googleapis.com/v1/projects/fake-project/occurrences:vulnerabilitySummary?alt=json&filter=%28%28has_prefix%28resourceUrl%2C+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%22%29%29%29+AND+%28%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Abbb222%22%29+OR+%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Accc333%22%29+OR+%28resourceUrl+%3D+%22us-west1-docker.pkg.dev%2Ffake-project%2Fmy-repo%2Fmy-image%40sha256%3Aaaa111%22%29%29
          method: GET
          headers: {}
          body: null
        return_response:
          headers:
            status: '200'
          body: |
            {
              "counts": [
                {
                  "severity": "SEVERITY_UNSPECIFIED",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 1,
                  "totalCount": 2
                },
                {
                  "severity": "CRITICAL",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 1,
                  "totalCount": 1
                },
                {
                  "severity": "HIGH",
                  "resourceUri": "us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:bbb222",
                  "fixableCount": 0,
                  "totalCount": 1
                }
              ]
            }
    - expect_stdout: |
        ---
        createTime: '2019-04-11T00:23:53.184760Z'
        package: us-west1-docker.pkg.dev/fake-project/my-repo/my-image
        tags: ''
        updateTime: '2019-04-11T00:23:53.184760Z'
        version: sha256:bbb222
        vuln_counts:
          CRITICAL: 1
          HIGH: 1
        ---
        BUILD:
        - build:
            provenance:
              buildVersion: 1.1.5
              creator: fake-creator@fake-mail.com
              id: fake-build-id
          kind: BUILD
          name: projects/fake-project/occurrences/3
          noteName: projects/build-project/notes/1
          resourceUri: us-west1-docker.pkg.dev/fake-project/my-repo/my-image@sha256:ccc333
        createTime: '2019-04-10T22:08:46.246729Z'
        package: us-west1-docker.pkg.dev/fake-project/my-repo/my-image
        tags: ''
        updateTime: '2019-04-10T22:08:46.246729Z'
        version: sha256:ccc333
        ---
        createTime: '2019-04-10T22:08:45.773883Z'
        package: us-west1-docker.pkg.dev/fake-project/my-repo/my-image
        tags: ''
        updateTime: '2019-04-10T22:08:45.773883Z'
        version: sha256:aaa111
    - expect_exit:
        code: 0
