title: artifacts repositories update test scenario
release_tracks: [ALPHA, BETA]
summary:
# This summary is generated by http://go/gcloud-scenario-tests on update and should not be edited.
- execute:
  - command: artifacts repositories update repo-name --location=us-west1 --description="New
      Description" --update-labels=newlabel=newvalue
  - stderr: |
      Updated repository [repo-name].
  - stdout: |
      createTime: '2020-09-18T20:34:57.318208Z'
      description: New Description
      format: DOCKER
      labels:
        newlabel: newvalue
        old: value
      name: projects/fake-project/locations/us-west1/repositories/repo-name
      updateTime: '2020-09-18T23:21:36.561191Z'
actions:
- execute_command:
    command: artifacts repositories update repo-name --location=us-west1 --description="New
      Description" --update-labels=newlabel=newvalue
    events:
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta1/projects/fake-project/locations/us-west1/repositories/repo-name?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/fake-project/locations/us-west1/repositories/repo-name",
              "format": "DOCKER",
              "description": "Original Description",
              "labels": {
                "old": "value"
              },
              "createTime": "2020-09-18T20:34:57.318208Z",
              "updateTime": "2020-09-18T23:21:36.561191Z"
            }
    - api_call:
        expect_request:
          uri: https://artifactregistry.googleapis.com/v1beta1/projects/fake-project/locations/us-west1/repositories/repo-name?alt=json&updateMask=description%2Clabels
          method: PATCH
          headers: {}
          body:
            json:
              createTime: '2020-09-18T20:34:57.318208Z'
              description: New Description
              format: DOCKER
              labels:
                newlabel: newvalue
                old: value
              name: projects/fake-project/locations/us-west1/repositories/repo-name
              updateTime: '2020-09-18T23:21:36.561191Z'
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/fake-project/locations/us-west1/repositories/repo-name",
              "format": "DOCKER",
              "description": "New Description",
              "labels": {
                "newlabel": "newvalue",
                "old": "value"
              },
              "createTime": "2020-09-18T20:34:57.318208Z",
              "updateTime": "2020-09-18T23:21:36.561191Z"
            }
    - expect_stderr: |
        Updated repository [repo-name].
    - expect_stdout: |
        createTime: '2020-09-18T20:34:57.318208Z'
        description: New Description
        format: DOCKER
        labels:
          newlabel: newvalue
          old: value
        name: projects/fake-project/locations/us-west1/repositories/repo-name
        updateTime: '2020-09-18T23:21:36.561191Z'
    - expect_exit:
        code: 0
