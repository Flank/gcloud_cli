title: dataproc metastore describe operation test scenario
release_tracks: [ALPHA]
summary:
# This summary is generated by http://go/gcloud-scenario-tests on update and should not be edited.
- execute:
  - command: |
      metastore operations wait foo --location us-central1
  - progress_tracker:
    - message: Waiting for operation [projects/fake-project/locations/us-central1/operations/foo]
        to complete
    - status: SUCCESS
  - stdout: |
      '@type': type.googleapis.com/google.cloud.metastore.v1alpha.Service
      artifactGcsUri: gs://gcs-bucket-test-gcloud-c52fa939-3d46-46a2-8242-29825c08318c
      createTime: '2020-08-07T18:05:02.456596335Z'
      endpointUri: thrift://10.20.64.23:9083
      hiveMetastoreConfig:
        configOverrides:
          hive.metastore.warehouse.dir: gs://gcs-bucket-test-gcloud-c52fa939-3d46-46a2-8242-29825c08318c/hive-warehouse
        version: 2.3.6
      name: projects/metastore-dogfood-cp/locations/us-east4/services/test-gcloud
      network: projects/metastore-dogfood-cp/global/networks/default
      port: 9083
      state: ACTIVE
      stateMessage: The service is ready to use
      tier: ENTERPRISE
      updateTime: '2020-08-07T18:05:14.016321078Z'
actions:
- execute_command:
    command: |
      metastore operations wait foo --location us-central1
    events:
    - api_call:
        expect_request:
          uri: https://metastore.googleapis.com/v1alpha/projects/fake-project/locations/us-central1/operations/foo?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/metastore-dogfood-cp/locations/us-east4/operations/operation-1596823502244-5ac4d719eca45-d8e97a3e-4fc30b36",
              "metadata": {
                "@type": "type.googleapis.com/google.cloud.metastore.v1alpha.OperationMetadata",
                "createTime": "2020-08-07T18:05:02.459724164Z",
                "endTime": "2020-08-07T18:32:10.191327663Z",
                "target": "projects/metastore-dogfood-cp/locations/us-east4/services/test-gcloud",
                "verb": "create",
                "requestedCancellation": false,
                "apiVersion": "v1alpha"
              },
              "done": true,
              "response": {
                "@type": "type.googleapis.com/google.cloud.metastore.v1alpha.Service",
                "name": "projects/metastore-dogfood-cp/locations/us-east4/services/test-gcloud",
                "createTime": "2020-08-07T18:05:02.456596335Z",
                "updateTime": "2020-08-07T18:05:14.016321078Z",
                "hiveMetastoreConfig": {
                  "version": "2.3.6",
                  "configOverrides": {
                    "hive.metastore.warehouse.dir": "gs://gcs-bucket-test-gcloud-c52fa939-3d46-46a2-8242-29825c08318c/hive-warehouse"
                  }
                },
                "network": "projects/metastore-dogfood-cp/global/networks/default",
                "endpointUri": "thrift://10.20.64.23:9083",
                "port": 9083,
                "state": "ACTIVE",
                "stateMessage": "The service is ready to use",
                "artifactGcsUri": "gs://gcs-bucket-test-gcloud-c52fa939-3d46-46a2-8242-29825c08318c",
                "tier": "ENTERPRISE"
              }
            }
    - expect_progress_tracker:
        message: Waiting for operation [projects/fake-project/locations/us-central1/operations/foo]
          to complete
        status: SUCCESS
    - expect_stdout: |
        '@type': type.googleapis.com/google.cloud.metastore.v1alpha.Service
        artifactGcsUri: gs://gcs-bucket-test-gcloud-c52fa939-3d46-46a2-8242-29825c08318c
        createTime: '2020-08-07T18:05:02.456596335Z'
        endpointUri: thrift://10.20.64.23:9083
        hiveMetastoreConfig:
          configOverrides:
            hive.metastore.warehouse.dir: gs://gcs-bucket-test-gcloud-c52fa939-3d46-46a2-8242-29825c08318c/hive-warehouse
          version: 2.3.6
        name: projects/metastore-dogfood-cp/locations/us-east4/services/test-gcloud
        network: projects/metastore-dogfood-cp/global/networks/default
        port: 9083
        state: ACTIVE
        stateMessage: The service is ready to use
        tier: ENTERPRISE
        updateTime: '2020-08-07T18:05:14.016321078Z'
    - expect_exit:
        code: 0
