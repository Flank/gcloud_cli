title: ai endpoints update scenario test
release_tracks: [ALPHA, BETA]
summary:
# This summary is generated by http://go/gcloud-scenario-tests on update and should not be edited.
- execute:
  - command: ai endpoints update e --region us-central1 --display-name updated_name
  - stderr: |
      Using endpoint [https://us-central1-aiplatform.googleapis.com/]
  - stderr: |
      Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
- execute:
  - command: ai endpoints update projects/fake-project/locations/us-central1/endpoints/e
      --display-name updated_name
  - stderr: |
      Using endpoint [https://us-central1-aiplatform.googleapis.com/]
  - stderr: |
      Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
- execute:
  - command: ai endpoints update e --region us-central1 --description updated_description
  - stderr: |
      Using endpoint [https://us-central1-aiplatform.googleapis.com/]
  - stderr: |
      Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
- execute:
  - command: ai endpoints update e --region us-central1 --traffic-split 01=100
  - stderr: |
      Using endpoint [https://us-central1-aiplatform.googleapis.com/]
  - stderr: |
      Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
- execute:
  - command: ai endpoints update e --region us-central1 --clear-traffic-split
  - stderr: |
      Using endpoint [https://us-central1-aiplatform.googleapis.com/]
  - stderr: |
      Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
- execute:
  - command: ai endpoints update e --region us-central1 --update-labels label1=value1
  - stderr: |
      Using endpoint [https://us-central1-aiplatform.googleapis.com/]
  - stderr: |
      Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
- execute:
  - command: ai endpoints update e --region us-central1 --remove-labels label1
  - stderr: |
      Using endpoint [https://us-central1-aiplatform.googleapis.com/]
  - stderr: |
      No update to perform.
- execute:
  - command: ai endpoints update e --region us-central1 --clear-labels
  - stderr: |
      Using endpoint [https://us-central1-aiplatform.googleapis.com/]
  - stderr: |
      No update to perform.
actions:
- define_reference:
    reference: api-version
    track_values:
      BETA: v1beta1
      ALPHA: v1beta1
- execute_command:
    command: ai endpoints update e --region us-central1 --display-name updated_name
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-aiplatform.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json&updateMask=display_name
          method: PATCH
          headers: {}
          body:
            json:
              displayName: updated_name
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/508879632478/locations/us-central1/endpoints/8769493636908843008",
              "displayName": "updated_name",
              "deployedModels": [
                {
                  "id": "2627428170105618432",
                  "model": "projects/508879632478/locations/us-central1/models/1682727779520479232",
                  "displayName": "sk_iris",
                  "createTime": "2020-09-09T22:41:38.867609Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                },
                {
                  "id": "7516085565616291840",
                  "model": "projects/508879632478/locations/us-central1/models/8036180953833406464",
                  "displayName": "xgb_iris",
                  "createTime": "2020-09-09T21:55:22.365077Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                }
              ],
              "trafficSplit": {
                "7516085565616291840": 100
              },
              "createTime": "2020-09-04T22:05:54.829911Z",
              "updateTime": "2020-09-22T22:32:06.209318Z"
            }
    - expect_stderr: |
        Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
    - expect_exit:
        code: 0
- execute_command:
    command: ai endpoints update projects/fake-project/locations/us-central1/endpoints/e
      --display-name updated_name
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-aiplatform.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json&updateMask=display_name
          method: PATCH
          headers: {}
          body:
            json:
              displayName: updated_name
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/508879632478/locations/us-central1/endpoints/8769493636908843008",
              "displayName": "updated_name",
              "deployedModels": [
                {
                  "id": "2627428170105618432",
                  "model": "projects/508879632478/locations/us-central1/models/1682727779520479232",
                  "displayName": "sk_iris",
                  "createTime": "2020-09-09T22:41:38.867609Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                },
                {
                  "id": "7516085565616291840",
                  "model": "projects/508879632478/locations/us-central1/models/8036180953833406464",
                  "displayName": "xgb_iris",
                  "createTime": "2020-09-09T21:55:22.365077Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                }
              ],
              "trafficSplit": {
                "7516085565616291840": 100
              },
              "createTime": "2020-09-04T22:05:54.829911Z",
              "updateTime": "2020-09-22T22:32:06.209318Z"
            }
    - expect_stderr: |
        Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
    - expect_exit:
        code: 0
- execute_command:
    command: ai endpoints update e --region us-central1 --description updated_description
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-aiplatform.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json&updateMask=description
          method: PATCH
          headers: {}
          body:
            json:
              description: updated_description
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/508879632478/locations/us-central1/endpoints/8769493636908843008",
              "displayName": "updated_name",
              "description": "updated_description",
              "deployedModels": [
                {
                  "id": "2627428170105618432",
                  "model": "projects/508879632478/locations/us-central1/models/1682727779520479232",
                  "displayName": "sk_iris",
                  "createTime": "2020-09-09T22:41:38.867609Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                },
                {
                  "id": "7516085565616291840",
                  "model": "projects/508879632478/locations/us-central1/models/8036180953833406464",
                  "displayName": "xgb_iris",
                  "createTime": "2020-09-09T21:55:22.365077Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                }
              ],
              "trafficSplit": {
                "7516085565616291840": 100
              },
              "createTime": "2020-09-04T22:05:54.829911Z",
              "updateTime": "2020-09-22T22:32:06.209318Z"
            }
    - expect_stderr: |
        Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
    - expect_exit:
        code: 0
- execute_command:
    command: ai endpoints update e --region us-central1 --traffic-split 01=100
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-aiplatform.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json&updateMask=traffic_split
          method: PATCH
          headers: {}
          body:
            json:
              trafficSplit:
                '01': 100
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/508879632478/locations/us-central1/endpoints/8769493636908843008",
              "displayName": "updated_name",
              "deployedModels": [
                {
                  "id": "2627428170105618432",
                  "model": "projects/508879632478/locations/us-central1/models/1682727779520479232",
                  "displayName": "sk_iris",
                  "createTime": "2020-09-09T22:41:38.867609Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                },
                {
                  "id": "7516085565616291840",
                  "model": "projects/508879632478/locations/us-central1/models/8036180953833406464",
                  "displayName": "xgb_iris",
                  "createTime": "2020-09-09T21:55:22.365077Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                }
              ],
              "trafficSplit": {
                "7516085565616291840": 100
              },
              "createTime": "2020-09-04T22:05:54.829911Z",
              "updateTime": "2020-09-22T22:32:06.209318Z"
            }
    - expect_stderr: |
        Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
    - expect_exit:
        code: 0
- execute_command:
    command: ai endpoints update e --region us-central1 --clear-traffic-split
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-aiplatform.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json&updateMask=traffic_split
          method: PATCH
          headers: {}
          body: null
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/508879632478/locations/us-central1/endpoints/8769493636908843008",
              "displayName": "updated_name",
              "deployedModels": [
                {
                  "id": "2627428170105618432",
                  "model": "projects/508879632478/locations/us-central1/models/1682727779520479232",
                  "displayName": "sk_iris",
                  "createTime": "2020-09-09T22:41:38.867609Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                },
                {
                  "id": "7516085565616291840",
                  "model": "projects/508879632478/locations/us-central1/models/8036180953833406464",
                  "displayName": "xgb_iris",
                  "createTime": "2020-09-09T21:55:22.365077Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                }
              ],
              "createTime": "2020-09-04T22:05:54.829911Z",
              "updateTime": "2020-09-22T22:32:06.209318Z"
            }
    - expect_stderr: |
        Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
    - expect_exit:
        code: 0
- execute_command:
    command: ai endpoints update e --region us-central1 --update-labels label1=value1
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-aiplatform.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json
          method: GET
          headers: {}
          body: null
        return_response:
          status: 200
          headers: {}
          body: null
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json&updateMask=labels
          method: PATCH
          headers: {}
          body:
            json:
              labels:
                label1: value1
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/508879632478/locations/us-central1/endpoints/8769493636908843008",
              "displayName": "updated_name",
              "deployedModels": [
                {
                  "id": "2627428170105618432",
                  "model": "projects/508879632478/locations/us-central1/models/1682727779520479232",
                  "displayName": "sk_iris",
                  "createTime": "2020-09-09T22:41:38.867609Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                },
                {
                  "id": "7516085565616291840",
                  "model": "projects/508879632478/locations/us-central1/models/8036180953833406464",
                  "displayName": "xgb_iris",
                  "createTime": "2020-09-09T21:55:22.365077Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                }
              ],
              "trafficSplit": {
                "7516085565616291840": 100
              },
              "labels": {
                "label1": "value1"
              },
              "createTime": "2020-09-04T22:05:54.829911Z",
              "updateTime": "2020-09-22T22:32:06.209318Z"
            }
    - expect_stderr: |
        Updated AI Platform endpoint [projects/508879632478/locations/us-central1/endpoints/8769493636908843008].
    - expect_exit:
        code: 0
- execute_command:
    command: ai endpoints update e --region us-central1 --remove-labels label1
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-aiplatform.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json
          method: GET
          headers: {}
          body: |
            {"labels": {"label2": "value2"}}
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/508879632478/locations/us-central1/endpoints/8769493636908843008",
              "displayName": "updated_name",
              "deployedModels": [
                {
                  "id": "2627428170105618432",
                  "model": "projects/508879632478/locations/us-central1/models/1682727779520479232",
                  "displayName": "sk_iris",
                  "createTime": "2020-09-09T22:41:38.867609Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                },
                {
                  "id": "7516085565616291840",
                  "model": "projects/508879632478/locations/us-central1/models/8036180953833406464",
                  "displayName": "xgb_iris",
                  "createTime": "2020-09-09T21:55:22.365077Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                }
              ],
              "trafficSplit": {
                "7516085565616291840": 100
              },
              "labels": {
                "label2": "value2"
              },
              "createTime": "2020-09-04T22:05:54.829911Z",
              "updateTime": "2020-09-22T22:32:06.209318Z"
            }
    - expect_stderr: |
        No update to perform.
    - expect_exit:
        code: 0
- execute_command:
    command: ai endpoints update e --region us-central1 --clear-labels
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-aiplatform.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-aiplatform.googleapis.com/$$api-version$$/projects/fake-project/locations/us-central1/endpoints/e?alt=json
          method: GET
          headers: {}
          body: |
            {"labels": {}}
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "projects/508879632478/locations/us-central1/endpoints/8769493636908843008",
              "displayName": "updated_name",
              "deployedModels": [
                {
                  "id": "2627428170105618432",
                  "model": "projects/508879632478/locations/us-central1/models/1682727779520479232",
                  "displayName": "sk_iris",
                  "createTime": "2020-09-09T22:41:38.867609Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                },
                {
                  "id": "7516085565616291840",
                  "model": "projects/508879632478/locations/us-central1/models/8036180953833406464",
                  "displayName": "xgb_iris",
                  "createTime": "2020-09-09T21:55:22.365077Z",
                  "dedicatedResources": {
                    "machineSpec": {
                      "machineType": "n1-standard-8"
                    },
                    "minReplicaCount": 1
                  }
                }
              ],
              "trafficSplit": {
                "7516085565616291840": 100
              },
              "createTime": "2020-09-04T22:05:54.829911Z",
              "updateTime": "2020-09-22T22:32:06.209318Z"
            }
    - expect_stderr: |
        No update to perform.
    - expect_exit:
        code: 0
