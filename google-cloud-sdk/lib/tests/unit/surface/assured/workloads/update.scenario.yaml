title: assured workloads update test
release_tracks: [BETA, ALPHA]
summary:
# This summary is generated by http://go/gcloud-scenario-tests on update and should not be edited.
- execute:
  - command: assured workloads update organizations/919698206570/locations/us-central1/workloads/00-7643501f-d6b9-4ebb-b5f9-ec4
      --display-name=Test-Workload-2 --labels labelkey1=labelvalue1 --etag=845793491
  - stderr: |
      Using endpoint [https://us-central1-assuredworkloads.googleapis.com/]
  - stderr: |
      Updated Assured Workloads environment [organizations/919698206570/locations/us-central1/workloads/00-7643501f-d6b9-4ebb-b5f9-ec4].
actions:
- execute_command:
    command: assured workloads update organizations/919698206570/locations/us-central1/workloads/00-7643501f-d6b9-4ebb-b5f9-ec4
      --display-name=Test-Workload-2 --labels labelkey1=labelvalue1 --etag=845793491
    events:
    - expect_stderr: |
        Using endpoint [https://us-central1-assuredworkloads.googleapis.com/]
    - api_call:
        expect_request:
          uri: https://us-central1-assuredworkloads.googleapis.com/v1beta1/organizations/919698206570/locations/us-central1/workloads/00-7643501f-d6b9-4ebb-b5f9-ec4?alt=json&updateMask=workload.display_name%2Cworkload.labels
          method: PATCH
          headers: {}
          body:
            json:
              displayName: Test-Workload-2
              etag: '845793491'
              labels:
                labelkey1: labelvalue1
        return_response:
          status: 200
          headers: {}
          body: |
            {
              "name": "organizations/919698206570/locations/us-central1/workloads/00-7643501f-d6b9-4ebb-b5f9-ec4",
              "displayName": "Test-Workload-2",
              "resources": [
                {
                  "resourceId": "135727243043"
                },
                {
                  "resourceId": "1056557247613"
                }
              ],
              "complianceRegime": "FEDRAMP_MODERATE",
              "createTime": "2020-08-27T08:17:47.287Z",
              "etag": "-546515440",
              "labels": {
                "labelkey1": "labelvalue1"
              }
            }
    - expect_stderr: |
        Updated Assured Workloads environment [organizations/919698206570/locations/us-central1/workloads/00-7643501f-d6b9-4ebb-b5f9-ec4].
    - expect_exit:
        code: 0
